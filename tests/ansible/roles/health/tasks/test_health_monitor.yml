---
- name: Add health monitor
  a10_health_monitor:
    a10_host: "{{ a10_host }}"
    a10_username: "{{ a10_username }}"
    a10_password: "{{ a10_password }}"
    a10_port: "{{ a10_port }}"
    a10_protocol: "{{ a10_protocol }}"
    name: sg1
  register: hm_resp
- assert:
    that:
      - "hm_resp['health']['monitor']['name'] == 'hm1'"

- name: Set health monitor method to tcp
  a10_health_monitor_method_tcp:
    a10_host: "{{ a10_host }}"
    a10_username: "{{ a10_username }}"
    a10_password: "{{ a10_password }}"
    a10_port: "{{ a10_port }}"
    a10_protocol: "{{ a10_protocol }}"
    name: sg1 
